# HTTPRoute for the preview deployment
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: webapp-preview-route-preview # from-param: ${ROUTE_NAME}
  namespace: webapp-dev
  annotations:
    # External DNS will create DNS record for this hostname
    external-dns.alpha.kubernetes.io/hostname: preview.webapp.u2i.dev # from-param: ${DOMAIN}
    external-dns.alpha.kubernetes.io/ttl: "300"
spec:
  hostnames: 
  - preview.webapp.u2i.dev # from-param: ${DOMAIN}
  parentRefs:
  - name: webapp-gateway
    namespace: infra-gw
  rules:
  - backendRefs:
    - name: preview-webapp-service
      port: 80